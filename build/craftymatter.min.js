!function(a){"use strict";function b(){i&&Crafty.e("Actor, Color").attr({x:0,y:0,w:d.world.bounds.max.x,h:d.world.bounds.max.y,alpha:.5,z:200}).color("green")}function c(a){var b=.04,c=Crafty.e("Actor"),d=Crafty.e("Actor, Color"),e=Crafty.e("Actor, Color"),f=Crafty.e("Actor, Color"),g=Crafty.e("Actor, Color"),h=Crafty.e("Actor, Color");return c.attach(d),c.attach(e),c.attach(f),c.attach(g),c.attach(h),c.attr({x:a.vertices[0].x,y:a.vertices[0].y,w:a.vertices[2].x-a.vertices[0].x,h:a.vertices[2].y-a.vertices[0].y}),d.color("blue"),d.alpha=.5,d.z=c._z+1,e.color("blue"),e.h=d._h*b,e.z=c._z+1,f.color("blue"),f.x=d._x+d._w*(1-b),f.w=d._w*b,f.z=c._z+1,g.color("blue"),g.y=d._y+d._h*(1-b),g.h=d._h*b,g.z=c._z+1,h.color("blue"),h.w=d._w*b,h.z=c._z+1,c}var d,e=a.World,f=a.Engine,g=a.Bodies,h=a.Common,i=!1,j=[],k={create:function(a){var b={controller:k,options:{width:640,height:960}},c=h.extend(b,a);return c},world:function(a){for(var b=a.world.bodies,c=0;c<b.length;c++)b[c].velocity.x+b[c].velocity.y!==0&&(j[c].x=b[c].position.x,j[c].y=b[c].position.y,i&&(j[c]._debugBody.x=b[c].position.x,j[c]._debugBody.y=b[c].position.y))}};Crafty.extend({Matter:function(){return{init:function(c){d=f.create({render:{controller:k,options:{width:Crafty.viewport.width,height:Crafty.viewport.height}}}),c&&(c.debug&&(i=c.debug),c.gravity&&(d.world.gravity=c.gravity)),d.world.bounds.max={x:Crafty.viewport.width,y:Crafty.viewport.height},b(),Crafty.bind("EnterFrame",function(b){a.Events.trigger(d,"beforeTick",event),f.update(d,1e3/b.dt,1),f.render(d),a.Events.trigger(d,"afterTick",event)})},destroy:function(){}}}()}),Crafty.c("Matter",function(){var b=function(a){j.push(this);var b={};a.matter&&(b=a.matter),this._body=g.rectangle(a.x+a.w/2,a.y+a.h/2,a.w,a.h,b),i&&(this._debugBody=c(this._body)),e.addBody(d.world,this._body)};return{init:function(){this.bind("Change",function(a){return a&&a.hasOwnProperty("x")&&a.hasOwnProperty("y")?b.call(this,a):void 0}.bind(this)),this.bind("Move",function(b){a.Body.setPosition(this._body,{x:this._x,y:this._y})}.bind(this))}}}())}(Matter);